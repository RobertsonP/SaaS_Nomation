<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #333; line-height: 1.6; }
    .header { border-bottom: 2px solid #eee; padding-bottom: 20px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center; }
    .logo { font-size: 24px; font-weight: bold; color: #2563EB; }
    .meta { font-size: 14px; color: #666; text-align: right; }
    .status-badge { padding: 5px 10px; border-radius: 4px; font-weight: bold; color: white; text-transform: uppercase; font-size: 12px; }
    .summary-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
    .card { background: #f9fafb; padding: 15px; border-radius: 8px; border: 1px solid #e5e7eb; }
    .card-label { font-size: 12px; color: #6b7280; text-transform: uppercase; font-weight: 600; margin-bottom: 5px; }
    .card-value { font-size: 18px; font-weight: bold; color: #111; }
    .steps { width: 100%; border-collapse: collapse; margin-top: 20px; }
    .steps th { text-align: left; padding: 12px; background: #f3f4f6; border-bottom: 2px solid #e5e7eb; font-size: 12px; text-transform: uppercase; color: #4b5563; }
    .steps td { padding: 12px; border-bottom: 1px solid #e5e7eb; vertical-align: top; }
    .step-status { display: inline-block; width: 10px; height: 10px; border-radius: 50%; }
    .error-box { background: #fee2e2; border: 1px solid #fca5a5; color: #b91c1c; padding: 15px; border-radius: 8px; margin: 20px 0; font-family: monospace; font-size: 12px; }
    .footer { margin-top: 50px; border-top: 1px solid #eee; padding-top: 20px; text-align: center; font-size: 12px; color: #999; }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo">Nomation</div>
    <div class="meta">
      <div>Execution ID: {{id}}</div>
      <div>{{formatDate startedAt}}</div>
    </div>
  </div>

  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
    <div>
      <h1 style="margin: 0; font-size: 28px;">{{test.name}}</h1>
      <p style="margin: 5px 0 0; color: #666;">Project: {{test.project.name}}</p>
    </div>
    <span class="status-badge" style="background-color: {{statusColor status}};">
      {{status}}
    </span>
  </div>

  <div class="summary-grid">
    <div class="card">
      <div class="card-label">Duration</div>
      <div class="card-value">{{duration}} ms</div>
    </div>
    <div class="card">
      <div class="card-label">Total Steps</div>
      <div class="card-value">{{results.totalSteps}}</div>
    </div>
    <div class="card">
      <div class="card-label">Organization</div>
      <div class="card-value">{{test.project.organization.name}}</div>
    </div>
  </div>

  {{#if errorMsg}}
  <div class="error-box">
    <strong>Error:</strong> {{errorMsg}}
  </div>
  {{/if}}

  <h3>Step Execution Details</h3>
  <table class="steps">
    <thead>
      <tr>
        <th width="50">#</th>
        <th>Action</th>
        <th>Selector / Value</th>
        <th width="100">Duration</th>
        <th width="80">Status</th>
      </tr>
    </thead>
    <tbody>
      {{#each results.steps}}
      <tr>
        <td>{{@index}}</td>
        <td><strong>{{action}}</strong><br><small style="color:#666">{{description}}</small></td>
        <td>
          {{#if selector}}<code style="background:#f3f4f6; padding:2px 4px; border-radius:3px;">{{selector}}</code>{{/if}}
          {{#if value}}<br>Value: {{value}}{{/if}}
        </td>
        <td>{{duration}}ms</td>
        <td>
          <span class="step-status" style="background-color: {{#if success}}#10B981{{else}}#EF4444{{/if}};"></span>
          {{#if success}}Pass{{else}}Fail{{/if}}
        </td>
      </tr>
      {{/each}}
    </tbody>
  </table>

  <div class="footer">
    Generated by Nomation Professional Reporting &bull; SaaS Test Automation Platform
  </div>
</body>
</html>
